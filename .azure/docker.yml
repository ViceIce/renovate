steps:
  - checkout: self
    fetchDepth: 5
    path: renovate

  - script: |
      export DOCKER_BUILDKIT=1
      docker build -t renovate-test -f Dockerfile.slim .
    displayName: Build slim renovate image

  - script: |
      docker run --rm renovate-test --version
      docker run --rm --entrypoint="podman" --privileged renovate-test --log-level info run docker/whalesay cowsay renovate
    displayName: Test slim renovate image
